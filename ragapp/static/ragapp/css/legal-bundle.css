/* ==========================================================
   LEGAL BUNDLE (Fallback Modal) — light/dark readable style
   File: static/ragapp/css/legal-bundle.css
   ========================================================== */

:root {
    /* 기본값: 살짝 어두운 글래스 모달 (다크에 최적화) */
    --lb-backdrop: rgba(15, 23, 42, 0.82);
    --lb-modal-bg: rgba(15, 23, 42, 0.96);
    --lb-border: rgba(148, 163, 184, 0.55);
    --lb-soft: rgba(148, 163, 184, 0.22);

    --lb-text: #f9fafb;
    /* 본문 텍스트 */
    --lb-dim: #e5e7eb;
    /* 보조 텍스트 */

    --lb-accent: #38bdf8;
    /* 링크/포인트 */
    --lb-accent-2: #6366f1;
    --lb-danger: #ef4444;

    --lb-radius: 20px;
    --lb-shadow:
        0 8px 30px rgba(0, 0, 0, .40),
        0 2px 12px rgba(0, 0, 0, .28);
    --lb-blur: 14px;

    --lb-tab-bg: rgba(15, 23, 42, 0.75);
    --lb-tab-on: linear-gradient(90deg, #38bdf8 0%, #6366f1 100%);
}

/* 라이트 모드: 흰 카드 + 진한 글씨 */
html[data-theme="light"] {
    --lb-backdrop: rgba(15, 23, 42, 0.55);
    --lb-modal-bg: #ffffff;
    --lb-border: rgba(148, 163, 184, 0.55);
    --lb-soft: rgba(148, 163, 184, 0.18);

    --lb-text: #111827;
    --lb-dim: #4b5563;

    --lb-tab-bg: rgba(226, 232, 240, 0.95);
}

/* 다크 모드: 더 진한 배경 + 거의 흰 글씨 */
html[data-theme="dark"] {
    --lb-backdrop: rgba(2, 6, 23, 0.88);
    --lb-modal-bg: rgba(15, 23, 42, 0.98);
    --lb-border: rgba(148, 163, 184, 0.65);
    --lb-soft: rgba(148, 163, 184, 0.26);

    --lb-text: #f9fafb;
    --lb-dim: #e5e7eb;

    --lb-tab-bg: rgba(15, 23, 42, 0.9);
}

/* page blur/lock */
body.legal-open {
    overflow: hidden;
}

/* -------- Backdrop -------- */
.legal-backdrop {
    position: fixed;
    inset: 0;
    z-index: 1000;
    background:
        radial-gradient(1200px 600px at 30% 10%, rgba(56, 189, 248, .10), transparent 60%),
        radial-gradient(1000px 500px at 80% 90%, rgba(99, 102, 241, .08), transparent 60%),
        var(--lb-backdrop);
    backdrop-filter: blur(2px);
    opacity: 0;
    transition: opacity .22s ease;
}

.legal-backdrop.show {
    opacity: 1;
}

.legal-backdrop[hidden] {
    display: none !important;
}

/* -------- Modal -------- */
.legal-modal {
    position: fixed;
    z-index: 1001;
    inset: 50% auto auto 50%;
    transform: translate(-50%, -44%) scale(.98);
    opacity: 0;
    pointer-events: none;
    width: min(860px, calc(100% - 28px));
    color: var(--lb-text);
    background: var(--lb-modal-bg);
    -webkit-backdrop-filter: blur(var(--lb-blur)) saturate(140%);
    backdrop-filter: blur(var(--lb-blur)) saturate(140%);
    border: 1px solid var(--lb-border);
    border-radius: var(--lb-radius);
    box-shadow: var(--lb-shadow);
    transition: opacity .22s ease, transform .22s ease;
}

.legal-modal.show {
    transform: translate(-50%, -50%) scale(1);
    opacity: 1;
    pointer-events: auto;
}

.legal-modal[hidden] {
    display: none !important;
}

/* Head */
.legal-head {
    position: sticky;
    top: 0;
    z-index: 2;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 18px 22px;
    background: linear-gradient(to bottom, rgba(15, 23, 42, .75), transparent);
    border-bottom: 1px solid var(--lb-soft);
}

html[data-theme="light"] .legal-head {
    background: linear-gradient(to bottom, rgba(248, 250, 252, .97), rgba(248, 250, 252, .92));
}

.legal-head h3 {
    margin: 0;
    font-size: 18px;
    font-weight: 700;
    letter-spacing: .2px;
    color: var(--lb-text);
}

.legal-close {
    position: absolute;
    right: 12px;
    top: 10px;
    width: 36px;
    height: 36px;
    border-radius: 999px;
    border: 1px solid var(--lb-border);
    background: rgba(255, 255, 255, .03);
    color: var(--lb-text);
    cursor: pointer;
    display: inline-grid;
    place-items: center;
    transition: transform .12s ease, background .12s ease, border-color .12s ease;
}

.legal-close:hover {
    transform: scale(1.06);
    background: rgba(255, 255, 255, .07);
    border-color: rgba(148, 163, 184, .35);
}

/* Tabs */
.legal-tabs {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    justify-content: center;
    margin: 8px auto 2px;
    padding: 8px;
    background: var(--lb-tab-bg);
    border: 1px solid var(--lb-soft);
    border-radius: 999px;
    width: max-content;
    max-width: calc(100% - 32px);
}

.legal-tab {
    appearance: none;
    border: 1px solid transparent;
    padding: 8px 14px;
    font-size: 13px;
    font-weight: 600;
    color: var(--lb-dim);
    background: transparent;
    border-radius: 999px;
    cursor: pointer;
    transition: color .12s ease, background .12s ease, transform .08s ease;
    white-space: nowrap;
}

.legal-tab:hover {
    color: var(--lb-text);
    transform: translateY(-1px);
}

.legal-tab[aria-selected="true"] {
    color: #0a0a0a;
    background: var(--lb-tab-on);
    box-shadow: 0 6px 14px rgba(56, 189, 248, .35);
}

/* Body */
.legal-body {
    padding: 16px 22px 22px;
    max-height: min(70vh, 680px);
    overflow: auto;
    line-height: 1.7;
    scrollbar-gutter: stable;
    color: var(--lb-text);
}

.legal-pane[hidden] {
    display: none !important;
}

.legal-body a {
    color: var(--lb-accent);
    text-decoration: none;
}

.legal-body a:hover {
    text-decoration: underline;
}

.legal-body h4 {
    margin: 12px 0 6px;
    font-size: 16px;
    color: var(--lb-text);
}

.legal-body p,
.legal-body li {
    color: var(--lb-text);
}

.legal-body .muted {
    color: var(--lb-dim);
}

/* nice scrollbar */
.legal-body::-webkit-scrollbar {
    height: 10px;
    width: 12px;
}

.legal-body::-webkit-scrollbar-thumb {
    background: linear-gradient(180deg,
            rgba(56, 189, 248, .55),
            rgba(99, 102, 241, .55));
    border-radius: 999px;
    border: 2px solid transparent;
    background-clip: padding-box;
}

.legal-body::-webkit-scrollbar-track {
    background: rgba(148, 163, 184, .10);
    border-radius: 999px;
}

/* Foot */
.legal-foot {
    position: sticky;
    bottom: 0;
    z-index: 2;
    display: flex;
    justify-content: center;
    gap: 10px;
    padding: 14px 16px 18px;
    background: linear-gradient(to top, rgba(15, 23, 42, .75), transparent);
    border-top: 1px solid var(--lb-soft);
}

html[data-theme="light"] .legal-foot {
    background: linear-gradient(to top, rgba(248, 250, 252, .97), rgba(248, 250, 252, .92));
}

/* Buttons (fallback if global .btn not present) */
.legal-foot .btn,
.legal-head .btn,
.btn.legal-btn {
    appearance: none;
    border: 1px solid rgba(148, 163, 184, .35);
    background: linear-gradient(180deg,
            rgba(255, 255, 255, .08),
            rgba(255, 255, 255, .02));
    color: var(--lb-text);
    padding: 10px 16px;
    border-radius: 12px;
    font-weight: 600;
    cursor: pointer;
    transition:
        transform .08s ease,
        box-shadow .12s ease,
        border-color .12s ease,
        background .12s ease;
}

.btn.legal-btn {
    backdrop-filter: blur(6px);
    box-shadow: 0 10px 20px rgba(0, 0, 0, .28);
}

.legal-foot .btn:hover,
.btn.legal-btn:hover {
    transform: translateY(-1px);
    border-color: rgba(148, 163, 184, .55);
    box-shadow:
        0 10px 26px rgba(56, 189, 248, .25),
        0 6px 14px rgba(99, 102, 241, .20);
}

/* CTA container at page bottom */
.legal-cta {
    position: sticky;
    bottom: 16px;
    z-index: 40;
    display: flex;
    justify-content: center;
    pointer-events: none;
}

.legal-cta .legal-btn {
    pointer-events: auto;
    background:
        radial-gradient(120px 60px at 50% 0%, rgba(56, 189, 248, .25), transparent 60%),
        linear-gradient(180deg, rgba(255, 255, 255, .06), rgba(255, 255, 255, .02));
    border: 1px solid rgba(99, 102, 241, .45);
}

/* Consent overlay */
.consent-overlay {
    position: fixed;
    inset: 0;
    z-index: 1200;
    display: grid;
    place-items: center;
    background: linear-gradient(180deg,
            rgba(2, 6, 23, .75),
            rgba(2, 6, 23, .55));
    backdrop-filter: blur(3px);
}

.consent-card {
    width: min(720px, calc(100% - 28px));
    border-radius: 18px;
    padding: 18px 20px;
    color: var(--lb-text);
    background: var(--lb-modal-bg);
    border: 1px solid var(--lb-border);
    box-shadow: var(--lb-shadow);
}

.consent-title {
    margin: .2rem 0 .5rem;
    font-size: 18px;
    font-weight: 800;
    color: var(--lb-text);
}

.consent-desc {
    margin: 0 0 .8rem;
    color: var(--lb-dim);
}

.consent-card a {
    color: var(--lb-accent);
    text-decoration: underline;
}

.consent-card a:hover {
    color: var(--lb-accent-2);
}

.opt-line {
    display: flex;
    align-items: center;
    gap: 10px;
    margin: .2rem 0 .2rem;
}

.opt-line label {
    color: var(--lb-text);
}

.consent-actions {
    display: flex;
    gap: 8px;
    justify-content: flex-end;
    margin-top: 10px;
}

.consent-err {
    margin-top: 8px;
    padding: 8px 10px;
    border-radius: 10px;
    color: #fecaca;
    background: rgba(239, 68, 68, .10);
    border: 1px solid rgba(239, 68, 68, .35);
}

/* Motion preference */
@media (prefers-reduced-motion: reduce) {

    .legal-backdrop,
    .legal-modal {
        transition: none !important;
    }
}

/* ==========================================
   동의 체크박스 문구 가독성 보정 (라이트/다크)
   ========================================== */

/* 라이트 모드 + 기본 모드( data-theme 없을 때 ) */
html[data-theme="light"] .consent-card .opt-line,
html[data-theme="light"] .consent-card .opt-line *,
html:not([data-theme]) .consent-card .opt-line,
html:not([data-theme]) .consent-card .opt-line * {
    color: #111827 !important;
    /* 진한 남색 글씨 */
}

/* 다크 모드 */
html[data-theme="dark"] .consent-card .opt-line,
html[data-theme="dark"] .consent-card .opt-line * {
    color: #e5e7eb !important;
    /* 거의 흰색 글씨 */
}

/* Small screens */
@media (max-width: 480px) {
    .legal-tabs {
        border-radius: 14px;
        padding: 6px;
        gap: 6px;
    }

    .legal-tab {
        padding: 7px 10px;
        font-size: 12px;
    }

    .legal-head {
        padding: 14px 18px;
    }

    .legal-foot {
        padding: 10px 12px 14px;
    }
}